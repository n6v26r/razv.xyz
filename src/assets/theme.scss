@use "@catppuccin/palette/scss/catppuccin" as *;
@use "sass:string";
@use "sass:map";

$theme-data: (
  "latte": ("scheme": light,
    "inverted-text": var(--base),
    "accent": var(--mauve),
    "highlight": var(--sapphire),
    "gradient": linear-gradient(90deg, var(--blue), var(--sapphire), var(--mauve)),
  ),
  "macchiato": ("scheme": dark,
    "inverted-text": var(--crust),
    "accent": var(--pink),
    "highlight": var(--blue),
    "gradient": linear-gradient(90deg, var(--blue), var(--lavender), var(--sky), var(--pink)),
  ),
  "frappe": ("scheme": dark,
    "inverted-text": var(--crust),
    "accent": var(--peach),
    "highlight": var(--red),
    "gradient": linear-gradient(90deg, var(--maroon), var(--red), var(--peach)),
  ),
  "mocha": ("scheme": dark,
    "inverted-text": var(--crust),
    "accent": var(--green),
    "highlight": var(--yellow),
    "gradient": linear-gradient(90deg, var(--green), var(--yellow), var(--peach), var(--red)),
  ),
);

@mixin theme($flavor) {
  @each $color, $value in map.get($palette, $flavor) {
    --#{$color}: #{$value};
  }

  --inverted-text: #{map.get(map.get($theme-data, $flavor), "inverted-text")};
  --selection-color: #{map.get(map.get($theme-data, $flavor), "accent")};
  --accent: #{map.get(map.get($theme-data, $flavor), "accent")};
  --highlight: #{map.get(map.get($theme-data, $flavor), "highlight")};
  --gradient: #{map.get(map.get($theme-data, $flavor), "gradient")};
}

:where([data-theme="system"]) {
  color-scheme: light dark;
  @include theme("mocha");

  @media (prefers-color-scheme: light) {
    @include theme("latte");
  }
}

@each $flavor, $data in $theme-data {
  :where([data-theme="#{$flavor}"]) {
    color-scheme: map.get($data, "scheme");
    @include theme($flavor);
  }
}

::selection {
  background: var(--selection-color);
  color: var(--inverted-text);
  text-shadow: none;
}

::-moz-selection {
  background: var(--selection-color);
  color: var(--inverted-text);
  text-shadow: none;
}